version: "3.1"

rules:

  - rule: Rispondi ai ringraziamenti
    steps:
      - intent: ringraziamento
      - action: utter_ringraziamento

  - rule: Gestisci l'addio
    steps:
      - intent: goodbye
      - action: utter_goodbye
      - action: action_reset_slots

  - rule: Fornisci aiuto
    steps:
      - intent: help
      - action: action_help

  - rule: Non ho capito
    steps:
      - intent: out_of_scope
      - action: utter_out_of_scope

  - rule: Reset degli slot su richiesta implicita
    steps:
      - intent: reset_slots
      - action: utter_reset
      - action: action_reset_slots

  # Flusso per la ricerca laptop (usa il form di ricerca)
  - rule: Gestisci la ricerca di laptop
    steps:
      - intent: cerca_laptop
      - action: laptop_search_form
      - active_loop: laptop_search_form

      # L'utente compila i campi: Rasa chiede usage e price_range.
      # Una volta che Rasa ha raccolto tutto, il form si completa automaticamente.

      - active_loop: null
      - action: action_suggerisci_laptop
      - action: action_reset_slots
  
  - rule: Gestisci il confronto di laptop
    steps:
      - intent: confronto_laptop
      - action: laptop_compare_form
      - active_loop: laptop_compare_form

      # Una volta che Rasa avrà ottenuto tutti e 8 gli slot richiesti:
      - active_loop: null
      - action: action_confronta_laptop

#  - rule: Gestisci consiglio di laptop
#    steps:
#      - intent: consiglia_laptop
#      - action: laptop_recommend_form
#      - active_loop: laptop_recommend_form

      # Al termine di usage e price_range:
#      - active_loop: null
#      - action: action_consiglia_laptop
#      - action: action_reset_slots

  # Flusso di dettagli laptop
  - rule: Riempimento price_range durante laptop_search_form
    condition:
      # Questa rule vale solo mentre è attivo il form
      - active_loop: laptop_search_form
    steps:
      - intent: provide_price_range
      - action: laptop_search_form

  # Flusso di confronto laptop
  #- rule: Riempimento info nel laptop_compare_form
  #  condition:
  #    - active_loop: laptop_compare_form
  #  steps:
  #    - intent: provide_compare_info
  #    - action: laptop_compare_form

  # Flusso di dettagli laptop per il suggerimento
  - rule: Riempimento usage/price_range in laptop_recommend_form
    condition:
      - active_loop: laptop_recommend_form
    steps:
      - intent: provide_recommend_info
      - action: laptop_recommend_form